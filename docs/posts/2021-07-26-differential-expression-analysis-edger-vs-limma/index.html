<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>ffli.dev: Differential Expression Analysis: edgeR vs limma</title>

<meta property="description" itemprop="description" content="Perform differential expression analysis&#10;and visualise differentially expressed genes in R."/>

<link rel="canonical" href="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-07-26"/>
<meta property="article:created" itemprop="dateCreated" content="2021-07-26"/>
<meta name="article:author" content="Feifei Li"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="ffli.dev: Differential Expression Analysis: edgeR vs limma"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Perform differential expression analysis&#10;and visualise differentially expressed genes in R."/>
<meta property="og:url" content="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"/>
<meta property="og:image" content="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/hm.png"/>
<meta property="og:image:width" content="700"/>
<meta property="og:image:height" content="432"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="ffli.dev"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="ffli.dev: Differential Expression Analysis: edgeR vs limma"/>
<meta property="twitter:description" content="Perform differential expression analysis&#10;and visualise differentially expressed genes in R."/>
<meta property="twitter:url" content="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"/>
<meta property="twitter:image" content="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/hm.png"/>
<meta property="twitter:image:width" content="700"/>
<meta property="twitter:image:height" content="432"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="ffli.dev: Differential Expression Analysis: edgeR vs limma"/>
<meta name="citation_fulltext_html_url" content="https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2021/07/26"/>
<meta name="citation_publication_date" content="2021/07/26"/>
<meta name="citation_author" content="Feifei Li"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Transcriptomic similarities and differences in host response between SARS-CoV-2 and other viral infections;citation_publication_date=2021;citation_volume=24;citation_doi=https://doi.org/10.1016/j.isci.2020.101947;citation_issn=2589-0042;citation_author=Simone A. Thair;citation_author=Yudong D. He;citation_author=Yehudit Hasin-Brumshtein;citation_author=Suraj Sakaram;citation_author=Rushika Pandya;citation_author=Jiaying Toh;citation_author=David Rawling;citation_author=Melissa Remmel;citation_author=Sabrina Coyle;citation_author=George N. Dalekos;citation_author=Ioannis Koutsodimitropoulos;citation_author=Glykeria Vlachogianni;citation_author=Eleni Gkeka;citation_author=Eleni Karakike;citation_author=Georgia Damoraki;citation_author=Nikolaos Antonakos;citation_author=Purvesh Khatri;citation_author=Evangelos J. Giamarellos-Bourboulis;citation_author=Timothy E. Sweeney"/>
  <meta name="citation_reference" content="citation_title=Complex heatmaps reveal patterns and correlations in multidimensional genomic data;citation_publication_date=2016;citation_volume=32;citation_doi=10.1093/bioinformatics/btw313;citation_issn=1367-4803;citation_author=Zuguang Gu;citation_author=Roland Eils;citation_author=Matthias Schlesner"/>
  <meta name="citation_reference" content="citation_title=circlize implements and enhances circular visualization in R ;citation_publication_date=2014;citation_volume=30;citation_doi=10.1093/bioinformatics/btu393;citation_issn=1367-4803;citation_author=Zuguang Gu;citation_author=Lei Gu;citation_author=Roland Eils;citation_author=Matthias Schlesner;citation_author=Benedikt Brors"/>
  <meta name="citation_reference" content="citation_title=edgeR: a Bioconductor package for differential expression analysis of digital gene expression data;citation_publication_date=2009;citation_volume=26;citation_doi=10.1093/bioinformatics/btp616;citation_issn=1367-4803;citation_author=Mark D. Robinson;citation_author=Davis J. McCarthy;citation_author=Gordon K. Smyth"/>
  <meta name="citation_reference" content="citation_title=Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation;citation_publication_date=2012;citation_volume=40;citation_doi=10.1093/nar/gks042;citation_issn=0305-1048;citation_author=Davis J. McCarthy;citation_author=Yunshun Chen;citation_author=Gordon K. Smyth"/>
  <meta name="citation_reference" content="citation_title=Interpretation of differential gene expression results of RNA-seq data: review and integration;citation_publication_date=2018;citation_volume=20;citation_doi=10.1093/bib/bby067;citation_issn=1477-4054;citation_author=Adam McDermaid;citation_author=Brandon Monier;citation_author=Jing Zhao;citation_author=Bingqiang Liu;citation_author=Qin Ma"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","bibliography","output","creative_commons","categories","preview","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Differential Expression Analysis: edgeR vs limma"]},{"type":"character","attributes":{},"value":["Perform differential expression analysis\nand visualise differentially expressed genes in R."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Feifei Li"]}]}]},{"type":"character","attributes":{},"value":["2021-07-26"]},{"type":"character","attributes":{},"value":["biblio.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["R","bioconductor","bioinformatics"]},{"type":"character","attributes":{},"value":["hm.png"]},{"type":"character","attributes":{},"value":["https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"]},{"type":"character","attributes":{},"value":["https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["biblio.bib","data/covid19_downregulated_genes.txt","data/covid19_ranked_genelist.txt","data/covid19_upregulated_genes.txt","data/normalised_counts.rds","data/samples.rds","differential-expression-analysis-edger-vs-limma_files/anchor-4.2.2/anchor.min.js","differential-expression-analysis-edger-vs-limma_files/bowser-1.9.3/bowser.min.js","differential-expression-analysis-edger-vs-limma_files/distill-2.2.21/template.v2.js","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-11-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-20-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-21-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-27-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-28-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-29-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-30-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-4-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-5-1.png","differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-7-1.png","differential-expression-analysis-edger-vs-limma_files/header-attrs-2.9/header-attrs.js","differential-expression-analysis-edger-vs-limma_files/jquery-1.11.3/jquery.min.js","differential-expression-analysis-edger-vs-limma_files/kePrint-0.0.1/kePrint.js","differential-expression-analysis-edger-vs-limma_files/lightable-0.0.1/lightable.css","differential-expression-analysis-edger-vs-limma_files/popper-2.6.0/popper.min.js","differential-expression-analysis-edger-vs-limma_files/tippy-6.2.7/tippy-bundle.umd.min.js","differential-expression-analysis-edger-vs-limma_files/tippy-6.2.7/tippy-light-border.css","differential-expression-analysis-edger-vs-limma_files/tippy-6.2.7/tippy.css","differential-expression-analysis-edger-vs-limma_files/tippy-6.2.7/tippy.umd.min.js","differential-expression-analysis-edger-vs-limma_files/webcomponents-2.0.0/webcomponents.js","hm.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* This theme is taken from Thomas's The Mockup Blog
   (https://github.com/jthomasmock/radix_themockup.git)
   I modified the theme based on my need.
   */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Lato');
@import url('https://fonts.googleapis.com/css2?family=Chivo');
@import url('https://fonts.googleapis.com/css2?family=Fira+Mono');

html {
    /*-- Main font sizes --*/
    --title-size:         50px;
    --body-size:          1.06rem;
    --code-size:          14px;
    --aside-size:         12px;
    --fig-cap-size:       13px;
    /*-- Main font colors --*/
    --title-color:        #000000;
    --header-color:       rgba(0, 0, 0, 0.8);
    --body-color:         rgba(0, 0, 0, 0.8);
    --aside-color:        rgba(0, 0, 0, 0.6);
    --fig-cap-color:      rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:       'Fira Mono', sans-serif;
    --mono-font:          'Fira Mono', monospace;
    --body-font:          'Lato', sans-serif;;
    --navbar-font:        "Fira Mono", serif;
    /* -- Darkmode -- */
    --darkmode-bg:        #121212;
    --darkmode-text:      #FFFFFF;
    --darkmode-contrast:  #BB86FC;
    --darkmode-error:     #CF6679;
    --darkmode-code-bg:   #212121;
    /* Lightmode */
    --lightmode-error:    #B00020;
    --lightmode-contrast: #ff6700;
}

/*-- ARTICLE METADATA --*/
.d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
}

/* -- ARTICLE PREVIEW IMAGE SIZE -- */
.posts-list .post-preview .thumbnail img {
    width: 50%;
    display: block;
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
}

.d-contents a {
    color:        var(--body-color);
    border-color: var(--body-color);
}

.d-contents li > *:hover {
    color:        var(--lightmode-contrast);
    border-color: var(--lightmode-contrast);
}

/* -- MAIN CATEGORY TAGS -- */
.posts-list .dt-tags .dt-tag:hover {
    color:        var(--lightmode-contrast);
    border-color: var(--lightmode-contrast);
}

/* -- ARTICLE PREVIEW */
.posts-list .post-preview .description h2:hover {
    color: var(--lightmode-contrast);
}

.posts-list .post-preview .description p:hover {
    color: var(--lightmode-contrast);
}

/*-- ARTICLE CATEGORY TAGS --*/
.dt-tag {
    color:        var(--body-color);
    border-color: var(--body-color);
}

.dt-tag:hover {
    color:        var(--lightmode-contrast);
    border-color: var(--lightmode-contrast);
}

/* -- ARTICLE CLICKABLE -- */
d-article a:hover {
    color: var(--lightmode-contrast);
    border-color: var(--lightmode-contrast);
}

/*-- ARTICLE APPENDIX --*/
.d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
}

/* -- HOME CATEGORIES -- */

.categories li>a:hover {
    color:         var(--lightmode-contrast);
    border-bottom: none;
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
    --title-size:       18px;
    --text-color:       #000;
    --text-size:        15px;
    --hover-color:      var(--lightmode-contrast);
    --bkgd-color:       white;
}

.distill-site-footer {
    --text-color:       #000;
    --text-size:        15px;
    --hover-color:      var(--lightmode-contrast);
    --bkgd-color:       white;
}

d-appendix p a:hover {
    color:        var(--lightmode-contrast);
    border-color: var(--lightmode-contrast);
}

d-appendix .citation-appendix, .d-appendix .citation-appendix {
    background: rgba(255, 250, 250, 1);
}

.social_footer {
    color: var(--body-color);
}

.social_footer a:hover {
    color: var(--lightmode-contrast);
}

/* -- DARKMODE CONFIG -- */
/* Buhr (2021, March 14). jmbuhr.de: Making a Darkmode for your distill site.
Retrieved from https://jmbuhr.de/posts/2021-03-14-making-a-darkmode-for-your-distill-site/ */
.darkmode {
    --title-color:     var(--darkmode-contrast);
    --header-color:    var(--darkmode-text);
    --body-color:      var(--darkmode-text);
    --aside-color:     var(--darkmode-text);
    --fig-cap-color:   var(--darkmode-text);
    --hover-color:     var(--darkmode-contrast);
    background-color:  var(--darkmode-bg);
    color:             var(--darkmode-text);
}

.darkmode d-article,
.darkmode d-appendix,
.darkmode body {
    background-color: var(--darkmode-bg);
    color:            var(--darkmode-text);
}

.darkmode d-title {
    color: var(--darkmode-text);
}

.darkmode d-article blockquote {
    color: var(--darkmode-text);
}

/*-- ARTICLE METADATA --*/
.darkmode d-byline {
    --heading-color:  var(--darkmode-text);
    --body-color:     var(--darkmode-text);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.darkmode .d-contents li > * {
    color:        var(--darkmode-text);
    border-color: var(--darkmode-text);
}

.darkmode .d-contents li > *:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

/* -- ARTICLE CLICKABLE -- */
.darkmode d-article a:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

/*-- ARTICLE APPENDIX --*/
.darkmode d-appendix {
    border-color:      var(--darkmode-text);
    --heading-color:   var(--darkmode-text);
    --text-color:      var(--darkmode-text);
}

.darkmode d-appendix a {
    color: var(--darkmode-text);
}

.darkmode d-appendix a:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

.darkmode .social_footer {
    color: var(--darkmode-text);
}

/*-- WEBSITE HEADER + FOOTER --*/
.darkmode .distill-site-header {
  --text-color:  var(--darkmode-text);
  --bkgd-color:  var(--darkmode-bg);
  --hover-color: var(--darkmode-contrast);
}

.darkmode .distill-site-footer {
  --text-color:  var(--darkmode-text);
  --bkgd-color:  var(--darkmode-bg);
  --hover-color: var(--darkmode-contrast);
}

.darkmode d-appendix p a:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

.darkmode d-appendix .citation-appendix, .d-appendix .citation-appendix {
    background: var(--darkmode-code-bg);
}

/*-- Categorical tags on main page --*/

.darkmode .categories li > * {
  color: var(--darkmode-text);
}

.darkmode .categories li>a:hover {
    color: var(--darkmode-contrast);
}

.darkmode .categories .active {
    color: var(--darkmode-contrast);
}

/*-- Categorical tags in blogs --*/
.darkmode .posts-list .dt-tags .dt-tag:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

.darkmode .dt-tags .dt-tag {
    color:        var(--darkmode-text);
    border-color: var(--darkmode-text);
}

.darkmode .dt-tag:hover {
    color:        var(--darkmode-contrast);
    border-color: var(--darkmode-contrast);
}

/* -- POST PREVIEW -- */
.darkmode .posts-list .post-preview {
    border-color: var(--darkmode-bg);
}

.darkmode .posts-list .post-preview .description h2:hover {
    color: var(--darkmode-contrast);
}

.darkmode .posts-list .post-preview .description p:hover {
    color: var(--darkmode-contrast);
}

/* -- CODE CHUNK -- */
.darkmode d-article div.sourceCode,
.darkmode code {
    background-color: var(--darkmode-code-bg);
}

.darkmode d-article pre {
    color: var(--darkmode-text);
}

.darkmode code span {
    color: var(--darkmode-text);
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.9/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Differential Expression Analysis: edgeR vs limma","description":"Perform differential expression analysis\nand visualise differentially expressed genes in R.","authors":[{"author":"Feifei Li","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-26T00:00:00.000+08:00","citationText":"Li, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">ffli.dev</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="https://github.com/ff98li">
<i class="fab fa-github-alt" aria-hidden="true"></i>
</a>
<a href="../../cv.pdf">
<i class="fas fa-graduation-cap" aria-hidden="true"></i>
</a>
<a>
<i class="fas fa-lightbulb" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Differential Expression Analysis: edgeR vs limma</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:R" class="dt-tag">R</a>
  <a href="../../index.html#category:bioconductor" class="dt-tag">bioconductor</a>
  <a href="../../index.html#category:bioinformatics" class="dt-tag">bioinformatics</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Perform differential expression analysis and visualise differentially expressed genes in R.</p></p>
</div>

<div class="d-byline">
  Feifei Li  
  
<br/>2021-07-26
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#visualising-expression-level">Visualising Expression Level</a>
<ul>
<li><a href="#standardising-expression-values">Standardising expression values</a></li>
<li><a href="#heatmap-annotation">Heatmap annotation</a></li>
</ul></li>
<li><a href="#de-analysis-by-quasi-likelihood-methods-qlm">DE Analysis by Quasi-Likelihood Methods (QLM)</a>
<ul>
<li><a href="#model-design">Model Design</a></li>
<li><a href="#multiple-hypothesis-testing-for-differentially-expressed-genes-by-qlm">Multiple Hypothesis Testing for Differentially Expressed Genes by QLM</a></li>
<li><a href="#ql-f-test-p-values-comparison-fdr-correcred-vs-uncorrected">QL F-test P-values Comparison: FDR-correcred vs Uncorrected</a></li>
<li><a href="#volcano-plot">Volcano Plot</a></li>
<li><a href="#heatmap-for-qlf-top-hit-genes">Heatmap for QLF top-hit Genes</a></li>
</ul></li>
<li><a href="#differential-expression-analysis-by-linear-models-of-mircroarray-limma">Differential Expression Analysis by Linear Models of MircroArray (Limma)</a>
<ul>
<li><a href="#multiple-hypothesis-testing">Multiple Hypothesis Testing</a></li>
<li><a href="#p-value-adjustment-methods">P-value adjustment methods</a></li>
<li><a href="#limma-p-values-comparison-bh-adjusted-vs-unadjusted">Limma P-values Comparison: BH-adjusted vs Unadjusted</a></li>
<li><a href="#volcano-plot-for-limma-top-hit-genes">Volcano Plot for Limma top-hit Genes</a></li>
<li><a href="#heatmap-for-limma-top-hit-genes">Heatmap for Limma top-hit Genes</a></li>
</ul></li>
<li><a href="#result-comparing-ql-f-test-and-limma-results">Result: Comparing QL F-test and Limma Results</a></li>
<li><a href="#to-do">To Do</a>
<ul>
<li><a href="#thresholded-list">Thresholded List</a></li>
<li><a href="#ranked-list">Ranked List</a></li>
</ul></li>
</ul>
</nav>
</div>
<p>The dataset being used here is <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE152641">GSE152641</a><span class="citation" data-cites="GSE152641">(<a href="#ref-GSE152641" role="doc-biblioref">Thair et al. 2021</a>)</span> Before differential expression analysis, we have done:</p>
<ul>
<li><a href="https://www.ffli.dev/posts/2021-07-05-geo-datasets-experiment-selection-and-initial-processing/">Initial RNA-seq data processing</a></li>
<li><a href="https://www.ffli.dev/posts/2021-07-11-comparing-hgnc-symbol-mappings-by-3-different-databases/">Mapping gene identifiers to HGNC gene names</a></li>
</ul>
<p>To load the processed RNA-seq data:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>normalised_counts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"./data/normalised_counts.rds"</span><span class='op'>)</span>
<span class='va'>samples</span>           <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"./data/samples.rds"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="visualising-expression-level">Visualising Expression Level</h2>
<p>We will be using <a href="https://bioconductor.org/packages/release/bioc/html/ComplexHeatmap.html">ComplexHeatmap</a><span class="citation" data-cites="complexheatmap">(<a href="#ref-complexheatmap" role="doc-biblioref">Gu, Eils, and Schlesner 2016</a>)</span> for heatmap visualisation of gene expression and <a href="https://github.com/jokergoo/circlize">circlize</a><span class="citation" data-cites="circlize">(<a href="#ref-circlize" role="doc-biblioref">Gu et al. 2014</a>)</span> to generate a colour gredient indicating expression levels of the genes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"circlize"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"circlize"</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ComplexHeatmap"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'>BiocManager</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocManager/man/install.html'>install</a></span><span class='op'>(</span><span class='st'>"ComplexHeatmap"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We write a function to create a color palette using <code>circlize</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>heatmap_cols</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>neg</span> <span class='op'>=</span> <span class='st'>"blue"</span>, <span class='va'>zero</span> <span class='op'>=</span> <span class='st'>"white"</span>, <span class='va'>pos</span> <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># Purpose:</span>
    <span class='co'>#     Helper function to create a transition colour gradient for a heatmap</span>
    <span class='co'># Parameters:</span>
    <span class='co'>#     mat: A RNA-seq count matrix</span>
    <span class='co'>#     neg: colour for negative expression values, green by default</span>
    <span class='co'>#     zero: colour for expression values of zero, black by default</span>
    <span class='co'>#     pos: colour for positive expression values, red by default</span>
    <span class='co'># Value:</span>
    <span class='co'>#     cols: a vector of colour gradient indicating expression level</span>
    
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'>## when the lowest expression value is 0</span>
        <span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'>circlize</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>colorRamp2</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span><span class='op'>)</span>,
                                     <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>zero</span>, <span class='va'>pos</span><span class='op'>)</span>
                                     <span class='op'>)</span>
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span> <span class='co'>## when the lowest expression value is negative</span>
        <span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'>circlize</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>colorRamp2</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span><span class='op'>)</span>,
                                     <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>neg</span>, <span class='va'>zero</span>, <span class='va'>pos</span><span class='op'>)</span>
                                     <span class='op'>)</span>
    <span class='op'>}</span>
    
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>One might ask, how could an expression value be negative? Before answering that, if we directly plot out the gene counts in a heatmap:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>Heatmap</a></span><span class='op'>(</span>
    matrix              <span class='op'>=</span> <span class='va'>normalised_counts</span>,
    column_title        <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Expression Levels of"</span>,
                                <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span><span class='op'>)</span>,
                                <span class='st'>"Genes in GSE152641"</span><span class='op'>)</span>,
    name                <span class='op'>=</span> <span class='st'>"Expr lvl"</span>,
    cluster_rows        <span class='op'>=</span> <span class='cn'>TRUE</span>,
    cluster_columns     <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_row_dend       <span class='op'>=</span> <span class='cn'>TRUE</span>,
    show_column_dend    <span class='op'>=</span> <span class='cn'>TRUE</span>,
    col                 <span class='op'>=</span> <span class='fu'>heatmap_cols</span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>,
    show_column_names   <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_row_names      <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_heatmap_legend <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>We can see nothing. The reason being is that most of the expression values were masked by some expression values that are extremely high. To explain this in a more intuitive way:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gene_dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>normalised_counts</span>, MARGIN <span class='op'>=</span> <span class='fl'>1</span>, FUN <span class='op'>=</span> <span class='va'>hist</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>gene_col</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>gene_dist</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>

<span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>;
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>gene_dist</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xlim</span>, <span class='va'>gene_dist</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>breaks</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ylim</span>, <span class='va'>gene_dist</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>counts</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## Find the row that has the max count</span>
<span class='va'>gene_max_count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>normalised_counts</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>,
                        arr.ind <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>x        <span class='op'>=</span> <span class='va'>xlim</span>,
     y        <span class='op'>=</span> <span class='va'>ylim</span>,
     type     <span class='op'>=</span> <span class='st'>"n"</span>,
     main     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Distributions for Expression Values of"</span>,
                      <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>, <span class='st'>"Genes"</span>,
                      <span class='st'>"in"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>, <span class='st'>"Samples"</span><span class='op'>)</span>,
     cex.main <span class='op'>=</span> <span class='fl'>0.95</span>,
     xlab     <span class='op'>=</span> <span class='st'>"TMM normalised CPM"</span>,
     ylab     <span class='op'>=</span> <span class='st'>"Frequency"</span>
<span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>gene_dist</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>gene_dist</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>,
         col <span class='op'>=</span> <span class='va'>gene_col</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>,
         lty <span class='op'>=</span> <span class='st'>"blank"</span>,
         add <span class='op'>=</span> <span class='cn'>TRUE</span>
    <span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>,
       legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span><span class='op'>[</span><span class='va'>gene_max_count</span><span class='op'>]</span>,
       fill   <span class='op'>=</span> <span class='va'>gene_col</span><span class='op'>[</span><span class='va'>gene_max_count</span><span class='op'>]</span>,
       border <span class='op'>=</span> <span class='va'>gene_col</span><span class='op'>[</span><span class='va'>gene_max_count</span><span class='op'>]</span>,
       cex    <span class='op'>=</span> <span class='fl'>0.75</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>As shown by the distributions, while only a few genes have high expression values, the majority of the genes have counts far below 20000. A few extremely high expression values can mask most of the other expression values in the heatmap. This is why the heatmap above showing virtually all the genes have the same level of expression in the 86 samples. To show the difference in expression levels between genes, we need to transform the expression values for each gene to comparable scales.</p>
<h3 id="standardising-expression-values">Standardising expression values</h3>
<p>A common practice before ploting RNA-seq data in a heatmap is to standardise the normalised counts of a gene across all samples to z-scores, that is, calculate z-scores by genes(rows):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>z_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span>                    <span class='co'>## transpose matrix =&gt; row = samples, col = genes</span>
    <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span>                    <span class='co'>## convert values of each column(gene) to Z scores</span>
        <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>
        <span class='op'>)</span>      <span class='co'>## transpose the transposed matrix =&gt; row =  genes, col = samples</span>
    <span class='op'>)</span>          
</code></pre>
</div>
</div>
<p>The heatmap after z-scoring:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>Heatmap</a></span><span class='op'>(</span>
    matrix              <span class='op'>=</span> <span class='va'>z_mat</span>,
    column_title        <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Expression Levels of"</span>,
                                <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span><span class='op'>)</span>,
                                <span class='st'>"Genes in 86 Samples of GSE152641"</span><span class='op'>)</span>,
    name                <span class='op'>=</span> <span class='st'>"Expr lvl"</span>,
    cluster_rows        <span class='op'>=</span> <span class='cn'>TRUE</span>,
    cluster_columns     <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_row_dend       <span class='op'>=</span> <span class='cn'>TRUE</span>,
    show_column_dend    <span class='op'>=</span> <span class='cn'>TRUE</span>,
    col                 <span class='op'>=</span> <span class='fu'>heatmap_cols</span><span class='op'>(</span><span class='va'>z_mat</span><span class='op'>)</span>,
    show_column_names   <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'>## Too many samples. Will be messy if show them</span>
    show_row_names      <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_heatmap_legend <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>The expression levels of the 14418 genes now become visible. However, we cannot tell which part of the heatmap corresponds to which sample, or more importantly which group of the 86 samples. Without this piece of information, it will be impossible to show the difference in gene expression level between the healthy control and the COVID-19 patients in the heatmap.</p>
<h3 id="heatmap-annotation">Heatmap annotation</h3>
<p>The <code>HeatmapAnnotation</code> object in <code>ComplexHeatmap</code> is dedicated to this purpose. The constructor method for <code>HeatmapAnnotation</code> requires two input arguments: a data frame with a column of group names for each sample and a list with a named vector of colour codes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## Create a vector named with sample groups</span>
<span class='va'>groups</span>         <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>    <span class='co'>## get group names of samples</span>
<span class='va'>ha_cols</span>        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#B00020"</span>, <span class='st'>"#008B00"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ha_cols</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>groups</span>
</code></pre>
</div>
</div>
<p>To present the annotation for the sample groups in a more organised way, we can re-arrange the column order of the count matrix by groups:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>==</span> <span class='va'>groups</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,
                 <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>==</span> <span class='va'>groups</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>    <span class='co'>## column index by groups</span>
</code></pre>
</div>
</div>
<p>And to create a heatmap annotation object using the constructor method:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ha</span> <span class='op'>&lt;-</span> <span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html'>HeatmapAnnotation</a></span><span class='op'>(</span>
        df  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Sample <span class='op'>=</span> <span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>[</span><span class='va'>group_order</span><span class='op'>]</span><span class='op'>)</span>,
        col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Sample <span class='op'>=</span> <span class='va'>ha_cols</span><span class='op'>)</span>
    <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The heatmap with an annotation for the sample groups:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>Heatmap</a></span><span class='op'>(</span>
    matrix              <span class='op'>=</span> <span class='va'>z_mat</span><span class='op'>[</span> , <span class='va'>group_order</span><span class='op'>]</span>,
    column_title        <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Expression Levels of"</span>,
                                <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span><span class='op'>)</span>,
                                <span class='st'>"Genes in 86 Samples of GSE152641"</span><span class='op'>)</span>,
    name                <span class='op'>=</span> <span class='st'>"Expr lvl"</span>,
    cluster_rows        <span class='op'>=</span> <span class='cn'>TRUE</span>,
    cluster_columns     <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_row_dend       <span class='op'>=</span> <span class='cn'>TRUE</span>,
    show_column_dend    <span class='op'>=</span> <span class='cn'>TRUE</span>,
    col                 <span class='op'>=</span> <span class='fu'>heatmap_cols</span><span class='op'>(</span><span class='va'>z_mat</span><span class='op'>)</span>,
    show_column_names   <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'>## Too many samples. Will be messy if show them</span>
    show_row_names      <span class='op'>=</span> <span class='cn'>FALSE</span>,
    show_heatmap_legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
    top_annotation      <span class='op'>=</span> <span class='va'>ha</span>      <span class='co'>## put annotation for sample groups at the top</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<p>Finally, putting everything above together, we can write a function to avoid duplicate code:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plotHeatMap</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>deg</span>   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,
                        <span class='va'>m</span>,
                        <span class='va'>samples</span>,
                        <span class='va'>title</span> <span class='op'>=</span> <span class='st'>""</span>,
                        <span class='va'>cols</span>  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#B00020"</span>, <span class='st'>"#008B00"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># Purpose:</span>
    <span class='co'>#     Ad-hoc function to standardise values in the input matrix to Z-scores,</span>
    <span class='co'>#     and generate a heatmap plot for gene expression with samples ordered</span>
    <span class='co'>#     by their groups and annotated.</span>
    <span class='co'># Parameters:</span>
    <span class='co'>#     deg    : a vector of differentially expressed genes </span>
    <span class='co'>#     m      : RNA-seq count matrix</span>
    <span class='co'>#     samples:</span>
    <span class='co'>#              A dataframe specifying to which group a sample belongs.</span>
    <span class='co'>#              Note that it only supports samples divided into 2 groups:</span>
    <span class='co'>#              control and experimental</span>
    <span class='co'>#     title  : Title for the heatmap</span>
    <span class='co'>#     cols   :</span>
    <span class='co'>#              Colours to annotate the heatmap by groups.</span>
    <span class='co'>#              Use preset colours if not supplied.</span>
    <span class='co'># Value:</span>
    <span class='co'>#     gene_heatmap: A heatmap object</span>
    
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jokergoo/ComplexHeatmap'>ComplexHeatmap</a></span><span class='op'>)</span>
    
    <span class='co'># Row normalisation/standardisation to Z-scores</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>deg</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span>
            <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span>
                <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>            <span class='co'># transpose matrix =&gt; row = samples, col = genes</span>
            <span class='op'>)</span>                  <span class='co'># convert values of each column(gene) to Z scores</span>
        <span class='op'>)</span>       <span class='co'># transpose the transposed matrix =&gt; row =  genes, col = samples</span>
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
        <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>deg</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span>
    
    <span class='co'># Get group names of samples</span>
    <span class='va'>groups</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>
    <span class='co'># Sample order by group</span>
    <span class='va'>group_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>==</span> <span class='va'>groups</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>,
                     <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span> <span class='op'>==</span> <span class='va'>groups</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='co'># Annotate heatmap by groups</span>
    <span class='va'>ha_cols</span>        <span class='op'>&lt;-</span> <span class='va'>cols</span>
    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ha_cols</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>groups</span>
    <span class='va'>ha</span> <span class='op'>&lt;-</span> <span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html'>HeatmapAnnotation</a></span><span class='op'>(</span>
        df  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Sample <span class='op'>=</span> <span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>[</span><span class='va'>group_order</span><span class='op'>]</span><span class='op'>)</span>,
        col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Sample <span class='op'>=</span> <span class='va'>ha_cols</span><span class='op'>)</span>
    <span class='op'>)</span>
    <span class='co'># Create a heatmap object</span>
    <span class='va'>gene_heatmap</span> <span class='op'>&lt;-</span> <span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>Heatmap</a></span><span class='op'>(</span>
        matrix              <span class='op'>=</span> <span class='va'>m</span><span class='op'>[</span> , <span class='va'>group_order</span><span class='op'>]</span>,
        column_title        <span class='op'>=</span> <span class='va'>title</span>,
        name                <span class='op'>=</span> <span class='st'>"Expr lvl"</span>,
        cluster_rows        <span class='op'>=</span> <span class='cn'>TRUE</span>,
        cluster_columns     <span class='op'>=</span> <span class='cn'>FALSE</span>,
        show_row_dend       <span class='op'>=</span> <span class='cn'>TRUE</span>,
        show_column_dend    <span class='op'>=</span> <span class='cn'>TRUE</span>,
        col                 <span class='op'>=</span> <span class='fu'>heatmap_cols</span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>,
        show_column_names   <span class='op'>=</span> <span class='cn'>FALSE</span>,
        show_row_names      <span class='op'>=</span> <span class='cn'>FALSE</span>,
        show_heatmap_legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
        top_annotation      <span class='op'>=</span> <span class='va'>ha</span>
    <span class='op'>)</span>
    
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>gene_heatmap</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h2 id="de-analysis-by-quasi-likelihood-methods-qlm">DE Analysis by Quasi-Likelihood Methods (QLM)</h2>
<h3 id="model-design">Model Design</h3>
<p>We hypothesise that COVID-19 status of samples was the only factor contributing to differential gene expression. Therefore, we model on <em>group</em> (status COVID-19 and healthy control) such that fitting this design matrix will tell us how the COVID-19 status of a sample explains his/her expression levels of the genes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>model_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>group</span>, data <span class='op'>=</span> <span class='va'>samples</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
(Intercept)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
groupHealthy control
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GSM4622627
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622628
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622629
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622630
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622631
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622632
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622633
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622634
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622635
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622636
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622637
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622638
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622639
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622640
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622641
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622642
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622643
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622644
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622645
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622646
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622647
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622648
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622649
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622650
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622651
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622652
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622653
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622654
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622655
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622656
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622657
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622658
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622659
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622660
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622661
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622662
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622663
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622664
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622665
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622666
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622668
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622669
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622670
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622671
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622672
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622673
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622674
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622675
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622676
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622677
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622678
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622679
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622680
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622681
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622682
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622683
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622684
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622685
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622686
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622687
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622688
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622689
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622690
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622691
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622692
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622693
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622694
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622695
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622696
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622697
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622698
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622699
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622700
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622701
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622702
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622703
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622704
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622705
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622706
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622707
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622708
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622709
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622710
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622711
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622712
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that <em>samples</em> is a data frame labeling samples with their groups:</p>
<div class="layout-chunk" data-layout="l-body">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sample
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GSM4622627
</td>
<td style="text-align:left;">
IMX_sample00001
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622628
</td>
<td style="text-align:left;">
IMX_sample00002
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622629
</td>
<td style="text-align:left;">
IMX_sample00003
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622630
</td>
<td style="text-align:left;">
IMX_sample00004
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622631
</td>
<td style="text-align:left;">
IMX_sample00005
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622632
</td>
<td style="text-align:left;">
IMX_sample00006
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622633
</td>
<td style="text-align:left;">
IMX_sample00007
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622634
</td>
<td style="text-align:left;">
IMX_sample00008
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622635
</td>
<td style="text-align:left;">
IMX_sample00009
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622636
</td>
<td style="text-align:left;">
IMX_sample00010
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622637
</td>
<td style="text-align:left;">
IMX_sample00011
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622638
</td>
<td style="text-align:left;">
IMX_sample00012
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622639
</td>
<td style="text-align:left;">
IMX_sample00013
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622640
</td>
<td style="text-align:left;">
IMX_sample00014
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622641
</td>
<td style="text-align:left;">
IMX_sample00015
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622642
</td>
<td style="text-align:left;">
IMX_sample00016
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622643
</td>
<td style="text-align:left;">
IMX_sample00017
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622644
</td>
<td style="text-align:left;">
IMX_sample00018
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622645
</td>
<td style="text-align:left;">
IMX_sample00019
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622646
</td>
<td style="text-align:left;">
IMX_sample00020
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622647
</td>
<td style="text-align:left;">
IMX_sample00021
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622648
</td>
<td style="text-align:left;">
IMX_sample00022
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622649
</td>
<td style="text-align:left;">
IMX_sample00023
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622650
</td>
<td style="text-align:left;">
IMX_sample00024
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622651
</td>
<td style="text-align:left;">
IMX_sample00025
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622652
</td>
<td style="text-align:left;">
IMX_sample00026
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622653
</td>
<td style="text-align:left;">
IMX_sample00027
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622654
</td>
<td style="text-align:left;">
IMX_sample00028
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622655
</td>
<td style="text-align:left;">
IMX_sample00029
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622656
</td>
<td style="text-align:left;">
IMX_sample00030
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622657
</td>
<td style="text-align:left;">
IMX_sample00031
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622658
</td>
<td style="text-align:left;">
IMX_sample00032
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622659
</td>
<td style="text-align:left;">
IMX_sample00033
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622660
</td>
<td style="text-align:left;">
IMX_sample00034
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622661
</td>
<td style="text-align:left;">
IMX_sample00035
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622662
</td>
<td style="text-align:left;">
IMX_sample00036
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622663
</td>
<td style="text-align:left;">
IMX_sample00037
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622664
</td>
<td style="text-align:left;">
IMX_sample00038
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622665
</td>
<td style="text-align:left;">
IMX_sample00039
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622666
</td>
<td style="text-align:left;">
IMX_sample00040
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622667
</td>
<td style="text-align:left;">
IMX_sample00041
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622668
</td>
<td style="text-align:left;">
IMX_sample00042
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622669
</td>
<td style="text-align:left;">
IMX_sample00043
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622670
</td>
<td style="text-align:left;">
IMX_sample00044
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622671
</td>
<td style="text-align:left;">
IMX_sample00045
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622672
</td>
<td style="text-align:left;">
IMX_sample00046
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622673
</td>
<td style="text-align:left;">
IMX_sample00047
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622674
</td>
<td style="text-align:left;">
IMX_sample00048
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622675
</td>
<td style="text-align:left;">
IMX_sample00049
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622676
</td>
<td style="text-align:left;">
IMX_sample00050
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622677
</td>
<td style="text-align:left;">
IMX_sample00051
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622678
</td>
<td style="text-align:left;">
IMX_sample00052
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622679
</td>
<td style="text-align:left;">
IMX_sample00053
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622680
</td>
<td style="text-align:left;">
IMX_sample00054
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622681
</td>
<td style="text-align:left;">
IMX_sample00055
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622682
</td>
<td style="text-align:left;">
IMX_sample00056
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622683
</td>
<td style="text-align:left;">
IMX_sample00057
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622684
</td>
<td style="text-align:left;">
IMX_sample00058
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622685
</td>
<td style="text-align:left;">
IMX_sample00059
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622686
</td>
<td style="text-align:left;">
IMX_sample00060
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622687
</td>
<td style="text-align:left;">
IMX_sample00061
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622688
</td>
<td style="text-align:left;">
IMX_sample00062
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622689
</td>
<td style="text-align:left;">
IMX_sample00063
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622690
</td>
<td style="text-align:left;">
IMX_sample00064
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622691
</td>
<td style="text-align:left;">
IMX_sample00065
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622692
</td>
<td style="text-align:left;">
IMX_sample00066
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622693
</td>
<td style="text-align:left;">
IMX_sample00067
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622694
</td>
<td style="text-align:left;">
IMX_sample00068
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622695
</td>
<td style="text-align:left;">
IMX_sample00069
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622696
</td>
<td style="text-align:left;">
IMX_sample00070
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622697
</td>
<td style="text-align:left;">
IMX_sample00071
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622698
</td>
<td style="text-align:left;">
IMX_sample00072
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622699
</td>
<td style="text-align:left;">
IMX_sample00073
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622700
</td>
<td style="text-align:left;">
IMX_sample00074
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622701
</td>
<td style="text-align:left;">
IMX_sample00075
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622702
</td>
<td style="text-align:left;">
IMX_sample00076
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622703
</td>
<td style="text-align:left;">
IMX_sample00077
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622704
</td>
<td style="text-align:left;">
IMX_sample00078
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622705
</td>
<td style="text-align:left;">
IMX_sample00079
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622706
</td>
<td style="text-align:left;">
IMX_sample00080
</td>
<td style="text-align:left;">
COVID19
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622707
</td>
<td style="text-align:left;">
IMX_sample00081
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622708
</td>
<td style="text-align:left;">
IMX_sample00082
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622709
</td>
<td style="text-align:left;">
IMX_sample00083
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622710
</td>
<td style="text-align:left;">
IMX_sample00084
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622711
</td>
<td style="text-align:left;">
IMX_sample00085
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
<tr>
<td style="text-align:left;">
GSM4622712
</td>
<td style="text-align:left;">
IMX_sample00086
</td>
<td style="text-align:left;">
Healthy control
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3 id="multiple-hypothesis-testing-for-differentially-expressed-genes-by-qlm">Multiple Hypothesis Testing for Differentially Expressed Genes by QLM</h3>
<p>We first use edgeR<span class="citation" data-cites="edgeR1">(<a href="#ref-edgeR1" role="doc-biblioref">Robinson, McCarthy, and Smyth 2009</a>)</span><span class="citation" data-cites="edgeR2">(<a href="#ref-edgeR2" role="doc-biblioref">McCarthy, Chen, and Smyth 2012</a>)</span> to estimate the dispersion. Note that edgeR stores data in a DGEList object and perform analyses on it:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>d</span>       <span class='op'>&lt;-</span> <span class='fu'>edgeR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></span><span class='op'>(</span>counts <span class='op'>=</span> <span class='va'>normalised_counts</span>,
                          group  <span class='op'>=</span> <span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='va'>d</span>       <span class='op'>&lt;-</span> <span class='fu'>edgeR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>model_design</span><span class='op'>)</span> <span class='co'># dispersion of normalised count</span>
<span class='va'>fit_qlm</span> <span class='op'>&lt;-</span> <span class='fu'>edgeR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>model_design</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In this step, QL dispersion was estimated with edgeR<span class="citation" data-cites="edgeR1">(<a href="#ref-edgeR1" role="doc-biblioref">Robinson, McCarthy, and Smyth 2009</a>)</span><span class="citation" data-cites="edgeR2">(<a href="#ref-edgeR2" role="doc-biblioref">McCarthy, Chen, and Smyth 2012</a>)</span> by fitting a QL negative binomial (NB) generalised linear model (glm) to the DGEList data containing the normalised counts and the estimated NB dispersions (visualised with <a href="https://www.ffli.dev/posts/2021-07-05-geo-datasets-experiment-selection-and-initial-processing/#biological-coefficient-of-variation-bcv">the BCV</a> and <a href="https://www.ffli.dev/posts/2021-07-05-geo-datasets-experiment-selection-and-initial-processing/#mean-variance-relationship">the mean-variance plot</a>), along with the design matrix we just created.</p>
<p>We then use the fitted result to conduct genewise QL F-test for the coefficients of our defined sample groups.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>qlf_SARS2vsHC</span> <span class='op'>&lt;-</span> <span class='fu'>edgeR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFTest</a></span><span class='op'>(</span><span class='va'>fit_qlm</span>, coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>model_design</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>This step calculates the p-values for each of the genes in our expression set.</p>
<h3 id="ql-f-test-p-values-comparison-fdr-correcred-vs-uncorrected">QL F-test P-values Comparison: FDR-correcred vs Uncorrected</h3>
<p>Extract the top differentially expressed tags ranked by p-values from the result of the QL F-test and display the number of genes that passed the correction:</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr>
<th style="text-align:right;">
Number of genes with p-value &lt; 0.05
</th>
<th style="text-align:right;">
Number of genes that pass after correction
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
7805
</td>
<td style="text-align:right;">
6856
</td>
</tr>
</tbody>
</table>
</div>
<p>The threshold for showing statistically significant evidence for differential expression was set to <span class="math inline">\(p &lt; 0.05\)</span> for each gene. This means genes that are captured only have less 5% chance to show such differences in expression between groups if they were non-differentially expressed genes.</p>
<p>Note that edgeR by default uses the false discovery rate (FDR/Benjamini-Hochberg) method to correct p-values for false positive results. This method was applied because we need to control for the the liklihood of false positive results that would increase by chance with the increasing number of tests performed. The threshold for the corrected p-value (FDR) is also set to be <span class="math inline">\(&lt;0.05\)</span> to capture genes that have false positive results for fewer than 5% of the significant tests.</p>
<h3 id="volcano-plot">Volcano Plot</h3>
<p>After hypothesis testing for detecting differentially expressed genes, it is of interest to compare the fold changes against the statistical significance levels. Commonly used to visualise this comparison for two treatment conditions is the volcano plot, where the horizontal dimension is the fold change between the two groups on the base-2 log scale, and the vertical dimension is the adjusted P-values on the negative base-10 log scale.</p>
<p>Another plot often used in interpreting the results of differential gene expression analysis is the MA plot, where the horizontal dimension is the mean of normalised gene counts (A) and the vertical dimension the fold changes, both on the base-2 log scale.<span class="citation" data-cites="DGEplot">(<a href="#ref-DGEplot" role="doc-biblioref">McDermaid et al. 2018</a>)</span> However, a volcano plot is a more preferable option to an MA plot for visualising DGE results, because an MA plot does not consider the association between the results of multiple hypothesis testing and the changes in expression levels between the two groups.</p>
<p>To create volcano plots with base R, we can write a simple function:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plotVolcano</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>title</span>, <span class='va'>gene_of_interest</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># Purpose:</span>
    <span class='co'>#     Plot a vocanol plot conveniently with highlighted genes of interest.</span>
    <span class='co'># Parameters:</span>
    <span class='co'>#     df: A dataframe dedicated to this dataset,</span>
    <span class='co'>#         must include the following ordered columns, regardless of names:</span>
    <span class='co'>#         column 1: HGNC gene symbol</span>
    <span class='co'>#         column 2: Fold change on log2 scale</span>
    <span class='co'>#         column 3: negated P-value on log10 scale</span>
    <span class='co'>#     title: title of the plot</span>
    <span class='co'>#     gene_of_interst:</span>
    <span class='co'>#         A vector of genes to highlight, optional</span>
    <span class='co'># Value:</span>
    <span class='co'>#     result: A volcano plot with genes of interest highlighted.</span>
    
    <span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"insig"</span>     <span class='op'>=</span> <span class='st'>"grey"</span>,
              <span class='st'>"sig"</span>       <span class='op'>=</span> <span class='st'>"#2cbe88"</span>,
              <span class='st'>"highlight"</span> <span class='op'>=</span> <span class='st'>"#d03b41"</span><span class='op'>)</span>
    
    <span class='va'>df</span><span class='op'>$</span><span class='va'>colour</span>         <span class='op'>&lt;-</span> <span class='va'>cols</span><span class='op'>[</span><span class='st'>"insig"</span><span class='op'>]</span>
    <span class='va'>sig</span>               <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>3</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>df</span><span class='op'>[</span><span class='va'>sig</span>, <span class='st'>"colour"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cols</span><span class='op'>[</span><span class='st'>"sig"</span><span class='op'>]</span>
    
    <span class='va'>highlight</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>gene_of_interest</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span>
        <span class='va'>highlight</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>1</span><span class='op'>]</span> <span class='op'>%in%</span> <span class='va'>gene_of_interest</span><span class='op'>)</span>

    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>df</span><span class='op'>[</span> ,<span class='fl'>2</span><span class='op'>]</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>df</span><span class='op'>[</span> ,<span class='fl'>3</span><span class='op'>]</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>highlight</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span>
        <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='st'>"colour"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cols</span><span class='op'>[</span><span class='st'>"highlight"</span><span class='op'>]</span>
    
    <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>x    <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='op'>-</span><span class='va'>highlight</span>, <span class='fl'>2</span><span class='op'>]</span>,
         y    <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='op'>-</span><span class='va'>highlight</span>, <span class='fl'>3</span><span class='op'>]</span>,
         col  <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='op'>-</span><span class='va'>highlight</span>, <span class='st'>"colour"</span><span class='op'>]</span>,
         xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"Log"</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='st'>" fold change"</span><span class='op'>)</span>,
         ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='st'>"-Log"</span><span class='op'>[</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>*</span><span class='st'>" P"</span><span class='op'>)</span>,
         main <span class='op'>=</span> <span class='va'>title</span><span class='op'>)</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>highlight</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x      <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='fl'>2</span><span class='op'>]</span>,
               y      <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='fl'>3</span><span class='op'>]</span>,
               col    <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='st'>"colour"</span><span class='op'>]</span>,
               pch    <span class='op'>=</span> <span class='fl'>8</span>,
               cex    <span class='op'>=</span> <span class='fl'>1.5</span>,
               lwd    <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span>x        <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='fl'>2</span><span class='op'>]</span>,
             y        <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='fl'>3</span><span class='op'>]</span>,
             labels   <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>highlight</span>, <span class='fl'>1</span><span class='op'>]</span>,
             cex      <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>,
               y      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>,
               legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"has evidence of DE"</span>,
                          <span class='st'>"insignificant"</span>,
                          <span class='st'>"gene of interest"</span><span class='op'>)</span>,
               col    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sig"</span><span class='op'>]</span>, <span class='va'>cols</span><span class='op'>[</span><span class='st'>"insig"</span><span class='op'>]</span>, <span class='va'>cols</span><span class='op'>[</span><span class='st'>"highlight"</span><span class='op'>]</span><span class='op'>)</span>,
               pch    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>8</span><span class='op'>)</span>,
               cex    <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span>
        
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
        <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>x      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>,
               y      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>,
               legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"has evidence of DE"</span>, <span class='st'>"insignificant"</span><span class='op'>)</span>,
               col    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>[</span><span class='st'>"sig"</span><span class='op'>]</span>, <span class='va'>cols</span><span class='op'>[</span><span class='st'>"insig"</span><span class='op'>]</span><span class='op'>)</span>,
               cex    <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span>
    <span class='op'>}</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h    <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>0.05</span><span class='op'>)</span>,
           col  <span class='op'>=</span> <span class='st'>"#0c82b7"</span>,
           lty  <span class='op'>=</span> <span class='fl'>2</span>,
           lwd  <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span>x      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>[</span> , <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>0.25</span>,
         y      <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>0.05</span><span class='op'>)</span>  <span class='op'>+</span> <span class='fl'>0.5</span>,
         labels <span class='op'>=</span> <span class='st'>"p = 0.05"</span>,
         col    <span class='op'>=</span> <span class='st'>"#0c82b7"</span><span class='op'>)</span>
    
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>There are also packages that offer functions to create fancy volcano/MA plots such as <code>vidger</code>, but it is more fun to write one yourself:)</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>qlf_volcano</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    gene       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>)</span>,
    log2FC     <span class='op'>=</span> <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>logFC</span>,
    neg_log10P <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'>plotVolcano</span><span class='op'>(</span>
    df               <span class='op'>=</span> <span class='va'>qlf_volcano</span>,
    title            <span class='op'>=</span> <span class='st'>"QL F-test Results for 14418 Genes (HC vs COVID-19)"</span>,
    gene_of_interest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ACO1"</span>, <span class='st'>"ATL3"</span>, <span class='st'>"ZC3H13"</span>, <span class='st'>"AMIGO1"</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>ACO1, ATL3, ZC3H13, and AMIGO1 are highlighted in the volcano plot. The reason is that the original study identified ACO1 and ATL3 to be completely discordant and oppositely regulated in COVID-19 and non-COVID-19 viral infections: ACO1 is over-expressed in COVID-19 and under-expressed in non-COVID19 infections, while ATL3 is under-expressed in COVID-19 and over-expressed in non-COVID-19 infections. The volcano plot is consistent with this observation made in the original study. As for ZC3H13 and AMIGO1, the author believes their expression may be inhibited by COVID-19 to escape the host response, and this is to be investigated in future studies.</p>
<h3 id="heatmap-for-qlf-top-hit-genes">Heatmap for QLF top-hit Genes</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tophits_qlf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span>
  <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>, <span class='op'>]</span>
  <span class='op'>)</span>

<span class='fu'>plotHeatMap</span><span class='op'>(</span>deg     <span class='op'>=</span> <span class='va'>tophits_qlf</span>,
            m       <span class='op'>=</span> <span class='va'>normalised_counts</span>,
            samples <span class='op'>=</span> <span class='va'>samples</span>,
            title   <span class='op'>=</span> <span class='st'>"Expression Levels of QLF Top-hit Genes"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>The heatmap plotted from the top-hit genes (<span class="math inline">\(\mathrm{FDR}&lt; 0.05\)</span>) from the differential expression analysis exhibits clusters of up-regulated and down-regulated expressions between the two group. This was not observed in the heatmap plotted using all the genes because here we have removed genes that show no significant evidence for differential expression for COVID-19 status (<span class="math inline">\(\mathrm{FDR}\geq 0.05\)</span>), which introduced noises in the first heatmap.</p>
<h2 id="differential-expression-analysis-by-linear-models-of-mircroarray-limma">Differential Expression Analysis by Linear Models of MircroArray (Limma)</h2>
<p><a href="10.18129/B9.bioc.limma">Limma</a><span class="citation" data-cites="limma">(<a href="#ref-limma" role="doc-biblioref">Ritchie et al. 2015</a>)</span> has two methods for differential expression analysis: the precision weights approach (voom) and the empirical Bayes prior trend approach (limma-trend). The later limma-trend appraoch is simpler and more robust than voom, provided that the sequencing depth across the RNA samples is reasonably consistent. According to <a href="http://www.bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf">the limma user guide</a>, the sequencing depth is considered to be reasonably consistent if the ratio of the largest library size to the smallest is not more than about 3-fold. The limma-trend method is applied here.<span class="citation" data-cites="limmaDEA">(<a href="#ref-limmaDEA" role="doc-biblioref">Phipson et al. 2016</a>)</span></p>
<h3 id="multiple-hypothesis-testing">Multiple Hypothesis Testing</h3>
<p>We are fitting the same model matrix as the one we used for the QLM fitting. Note that limma uses logCPM rather than CPM itself:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_limma</span> <span class='op'>&lt;-</span> <span class='fu'>limma</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/lmFit.html'>lmFit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>,
                          design <span class='op'>=</span> <span class='va'>model_design</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Then we apply empircal Bayes to compute differential expression:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit_limma</span> <span class='op'>&lt;-</span> <span class='fu'>limma</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></span><span class='op'>(</span>
    fit   <span class='op'>=</span> <span class='va'>fit_limma</span>,
    trend <span class='op'>=</span> <span class='cn'>T</span> <span class='co'># specific to RNA-seq, as we are not working with microarray data</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Get the top hits ranked by P-values:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>limma_output_hits</span> <span class='op'>&lt;-</span> <span class='fu'>limma</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span>
    fit           <span class='op'>=</span> <span class='va'>fit_limma</span>,
    coef          <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>fit_limma</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"groupHealthy control"</span><span class='op'>)</span>,
    adjust.method <span class='op'>=</span> <span class='st'>"BH"</span>, <span class='co'># use Benjamni-Hochberg to correct for p-values</span>
    number        <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>normalised_counts</span><span class='op'>)</span>
    <span class='op'>)</span>
<span class='va'>limma_output_hits</span> <span class='op'>&lt;-</span> <span class='va'>limma_output_hits</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>P.Value</span><span class='op'>)</span>, <span class='op'>]</span>
</code></pre>
</div>
</div>
<h3 id="p-value-adjustment-methods">P-value adjustment methods</h3>
<p>For the results of empircal Bayes, we are able to select whatever p-value correction mathods R offers:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p.adjust.methods</span>
</code></pre>
</div>
<pre><code>[1] &quot;holm&quot;       &quot;hochberg&quot;   &quot;hommel&quot;     &quot;bonferroni&quot; &quot;BH&quot;        
[6] &quot;BY&quot;         &quot;fdr&quot;        &quot;none&quot;      </code></pre>
</div>
<p>Note that <em>BH</em> and <em>fdr</em> are synonymous; they both refer to the Benjamini-Hochberg procedure for FDR control. According to R documentation for these adjustment methods, <em>holm</em>, <em>hochberg</em>, <em>hommel</em>, and <em>bonferroni</em> are designed to control the family-wise error rate (the probability of making one or more false postive discoveries; Type 1 error) and they control the probability of making such error in the multi-hypotheses testing. <em>BH/fdr</em> and <em>BY</em> on the other hand allow false positive results, but control the proportion out of the significant tests. This means the latter two methods are less conservative and stringent than the first four. Although <em>hommel</em> is a more powerful method, the R documentation states that the difference between the results of these two methods are small while the p-values of <em>BH</em> are faster to calculate. Therefore the FDR method was also chosen here.</p>
<h3 id="limma-p-values-comparison-bh-adjusted-vs-unadjusted">Limma P-values Comparison: BH-adjusted vs Unadjusted</h3>
<p>Check the number of genes that have P-values below the 0.05 cutoff and genes that have Benjamni-Hochberg corrected P-values below the cutoff:</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr>
<th style="text-align:right;">
Number of genes with p-value &lt; 0.05
</th>
<th style="text-align:right;">
Number of genes that pass after correction
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
8222
</td>
<td style="text-align:right;">
7361
</td>
</tr>
</tbody>
</table>
</div>
<p>The result is similar to that of the QLM F-test, with more genes that passed the corrected p-value threshold.</p>
<h3 id="volcano-plot-for-limma-top-hit-genes">Volcano Plot for Limma top-hit Genes</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>limma_volcano</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    gene       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>limma_output_hits</span><span class='op'>)</span>,
    log2FC     <span class='op'>=</span> <span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>logFC</span>,
    neg_log10P <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>adj.P.Val</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'>plotVolcano</span><span class='op'>(</span>
    df               <span class='op'>=</span> <span class='va'>limma_volcano</span>,
    title            <span class='op'>=</span> <span class='st'>"Limma-eBayes Results for 14418 Genes (HC)"</span>,
    gene_of_interest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ACO1"</span>, <span class='st'>"ATL3"</span>, <span class='st'>"ZC3H13"</span>, <span class='st'>"AMIGO1"</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>The volcano plot is nearly identical to the one for the edgeR result.</p>
<h3 id="heatmap-for-limma-top-hit-genes">Heatmap for Limma top-hit Genes</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tophits_limma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>limma_output_hits</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span>
    <span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='fu'>plotHeatMap</span><span class='op'>(</span>deg     <span class='op'>=</span> <span class='va'>tophits_limma</span>,
            m       <span class='op'>=</span> <span class='va'>normalised_counts</span>,
            title   <span class='op'>=</span> <span class='st'>"Expression Levels of Limma Top-hit Genes"</span>,
            samples <span class='op'>=</span> <span class='va'>samples</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<p>The heatmap for the limma top-hit genes has the same pattern of clusters as the one for the QLF top-hit genes. This again is because we only retain genes that are shown to be significantly differentially expressed by limma-eBayes, and plotted the two groups side-by-side for comparison.</p>
<h2 id="result-comparing-ql-f-test-and-limma-results">Result: Comparing QL F-test and Limma Results</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Scatter plots for un-adjusted p-values ======================================</span>
<span class='va'>qlf_pvalues</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    gene_name      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>)</span>,
    qlf_pvalue     <span class='op'>=</span> <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>PValue</span>,
    qlf_pvalue_adj <span class='op'>=</span> <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span>
    <span class='op'>)</span>
<span class='va'>limma_pvalues</span>     <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    gene_name        <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>limma_output_hits</span><span class='op'>)</span>,
    limma_pvalue     <span class='op'>=</span> <span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>P.Value</span>,
    limma_pvalue_adj <span class='op'>=</span> <span class='va'>limma_output_hits</span><span class='op'>$</span><span class='va'>adj.P.Val</span>
    <span class='op'>)</span>
<span class='va'>qlf_limma_pvalues</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span>
    x    <span class='op'>=</span> <span class='va'>qlf_pvalues</span>,
    y    <span class='op'>=</span> <span class='va'>limma_pvalues</span>,
    by.x <span class='op'>=</span> <span class='st'>"gene_name"</span>,
    by.y <span class='op'>=</span> <span class='st'>"gene_name"</span>,
<span class='op'>)</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span> <span class='op'>&lt;-</span> <span class='st'>"grey"</span>
<span class='co'># Colour for QLF p-values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span>
    <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#92d964"</span>
<span class='co'># colours for limma p-values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span>
    <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#29a2ca"</span>
<span class='co'># Colour for intersection of QLF and limma p values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue</span>   <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#fae213"</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
    x        <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue</span>,
    y        <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue</span>,
    col      <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span>,
    xlab     <span class='op'>=</span> <span class='st'>"Limma Unadjusted P-values"</span>,
    ylab     <span class='op'>=</span> <span class='st'>"QLF Unadjusted P-values"</span>,
    cex.lab  <span class='op'>=</span> <span class='fl'>0.75</span>,
    main     <span class='op'>=</span> <span class='st'>"QLF vs Limma for Unadjusted P-values"</span>,
    cex.main <span class='op'>=</span> <span class='fl'>0.75</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>
    x      <span class='op'>=</span> <span class='fl'>0</span>,
    y      <span class='op'>=</span> <span class='fl'>1</span>,
    legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"QLF"</span>, <span class='st'>"Limma"</span>, <span class='st'>"Both"</span>, <span class='st'>"not significant"</span><span class='op'>)</span>,
    fill   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#92d964"</span>, <span class='st'>"#29a2ca"</span>, <span class='st'>"#fae213"</span>, <span class='st'>"grey"</span><span class='op'>)</span>,
    cex    <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span> <span class='op'>&lt;-</span> <span class='st'>"grey"</span>
<span class='co'># Scatter plots for adjusted p-values =========================================</span>
<span class='co'># Colour for FDR-corrected QLF p-values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue_adj</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#168c6e"</span>
<span class='co'># Colour for BH-adjusted limma p-values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue_adj</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#234eaa"</span>
<span class='co'># Colour for intersection of corrected QLF and limma p values below cutoff</span>
<span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue_adj</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span>
    <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue_adj</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"#cb641d"</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
    x        <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>limma_pvalue_adj</span>,
    y        <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>qlf_pvalue_adj</span>,
    col      <span class='op'>=</span> <span class='va'>qlf_limma_pvalues</span><span class='op'>$</span><span class='va'>colour</span>,
    xlab     <span class='op'>=</span> <span class='st'>"Limma BH-corrected P-values"</span>,
    ylab     <span class='op'>=</span> <span class='st'>"QLF FDR-corrected P-values"</span>,
    cex.lab  <span class='op'>=</span> <span class='fl'>0.75</span>,
    main     <span class='op'>=</span> <span class='st'>"QLF vs Limma for Adjusted P-values"</span>,
    cex.main <span class='op'>=</span> <span class='fl'>0.75</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span>
    x        <span class='op'>=</span> <span class='fl'>0</span>,
    y        <span class='op'>=</span> <span class='fl'>1</span>,
    legend   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"QLF"</span>, <span class='st'>"Limma"</span>, <span class='st'>"Both"</span>, <span class='st'>"not significant"</span><span class='op'>)</span>,
    fill     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#168c6e"</span>, <span class='st'>"#234eaa"</span>, <span class='st'>"#cb641d"</span>, <span class='st'>"grey"</span><span class='op'>)</span>,
    cex      <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="differential-expression-analysis-edger-vs-limma_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<p>The p-values calculated by QLF and Limma methods appear to be patternless. These two methods only capture a small common subset of differentially expressed genes. A question one might ask is, which method is better to use. Unfortunately this is also a question that I have not been able to answer. For RNA-seq differential expression analysis, I prefer edgeR to limma as limma is mostly used for microarray analyses, and the RNA-seq data is analysed as if it was microarray data by limma.</p>
<h2 id="to-do">To Do</h2>
<p>In later posts, enrichment or over-representation analysis (ORA) will be performed based on the DE analysis result by edgeR. Before performing the enrichment analysis, we need to create thresholded lists of genes for thresholded ORA and a ranked gene list for gene set enrichment analysis (GSEA).</p>
<h3 id="thresholded-list">Thresholded List</h3>
<p>We need to create 2 thresholded lists: one for the differentially expressed genes that were up-regulated, and one for those downregulated, with a threshold of 0.05 for the FDR-corrected p-value.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>upregulated_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span>
<span class='op'>)</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.table</a></span><span class='op'>(</span>x         <span class='op'>=</span> <span class='va'>upregulated_genes</span>,
            file      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='st'>"."</span>, <span class='st'>"data"</span>, <span class='st'>"covid19_upregulated_genes.txt"</span><span class='op'>)</span>,
            sep       <span class='op'>=</span> <span class='st'>"\t"</span>,
            row.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            col.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            quote     <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>downregulated_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span>
    <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span>
<span class='op'>)</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.table</a></span><span class='op'>(</span>x         <span class='op'>=</span> <span class='va'>downregulated_genes</span>,
            file      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='st'>"."</span>, <span class='st'>"data"</span>, <span class='st'>"covid19_downregulated_genes.txt"</span><span class='op'>)</span>,
            sep       <span class='op'>=</span> <span class='st'>"\t"</span>,
            row.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            col.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            quote     <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="ranked-list">Ranked List</h3>
<p>A non-thresholded, ranked list of genes for GSEA:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gene_rank</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    genename <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>)</span>,
    F_stat   <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>FDR</span>,
                    base <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sign.html'>sign</a></span><span class='op'>(</span><span class='va'>qlf_output_hits</span><span class='op'>$</span><span class='va'>table</span><span class='op'>$</span><span class='va'>logFC</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.table</a></span><span class='op'>(</span>x         <span class='op'>=</span> <span class='va'>gene_rank</span>,
            file      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='st'>"."</span>, <span class='st'>"data"</span>, <span class='st'>"covid19_ranked_genelist.txt"</span><span class='op'>)</span>,
            sep       <span class='op'>=</span> <span class='st'>"\t"</span>,
            row.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            col.names <span class='op'>=</span> <span class='cn'>FALSE</span>,
            quote     <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Note that we define the rank to be <span class="math inline">\(-\log_{10}{\mathrm{FDR}} \ \cdot\ \operatorname{sgn}(\log{\mathrm{FC}})\)</span>. With the <span class="math inline">\(-\log_{10}{\mathrm{FDR}}\)</span>, the samller the (corrected) p-value for a gene is, the higher the rank of that gene, regardless of whether it is up- or downregulated. The other term <span class="math inline">\(\operatorname{sgn}(\log{\mathrm{FC}})\)</span> take into account the factor of regulation of gene expression: if it is up-regulated, then it will be ranked from the top; if it is down-regulated, then it will be ranked from the bottom. Thereby we have genes that show the most statistically significant evidence of differential expression at the top for those upregulated, and the bottom of the list for those downregulated, while genes in the middle are least significant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-complexheatmap" class="csl-entry" role="doc-biblioentry">
Gu, Zuguang, Roland Eils, and Matthias Schlesner. 2016. <span><span class="nocase">Complex heatmaps reveal patterns and correlations in multidimensional genomic data</span>.</span> <em>Bioinformatics</em> 32 (18): 284749. <a href="https://doi.org/10.1093/bioinformatics/btw313">https://doi.org/10.1093/bioinformatics/btw313</a>.
</div>
<div id="ref-circlize" class="csl-entry" role="doc-biblioentry">
Gu, Zuguang, Lei Gu, Roland Eils, Matthias Schlesner, and Benedikt Brors. 2014. <span><span class="nocase">circlize implements and enhances circular visualization in R </span>.</span> <em>Bioinformatics</em> 30 (19): 281112. <a href="https://doi.org/10.1093/bioinformatics/btu393">https://doi.org/10.1093/bioinformatics/btu393</a>.
</div>
<div id="ref-edgeR2" class="csl-entry" role="doc-biblioentry">
McCarthy, Davis J., Yunshun Chen, and Gordon K. Smyth. 2012. <span><span class="nocase">Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</span>.</span> <em>Nucleic Acids Research</em> 40 (10): 428897. <a href="https://doi.org/10.1093/nar/gks042">https://doi.org/10.1093/nar/gks042</a>.
</div>
<div id="ref-DGEplot" class="csl-entry" role="doc-biblioentry">
McDermaid, Adam, Brandon Monier, Jing Zhao, Bingqiang Liu, and Qin Ma. 2018. <span><span class="nocase">Interpretation of differential gene expression results of RNA-seq data: review and integration</span>.</span> <em>Briefings in Bioinformatics</em> 20 (6): 204454. <a href="https://doi.org/10.1093/bib/bby067">https://doi.org/10.1093/bib/bby067</a>.
</div>
<div id="ref-limmaDEA" class="csl-entry" role="doc-biblioentry">
Phipson, Belinda, Stanley Lee, Ian J. Majewski, Warren S. Alexander, and Gordon K. Smyth. 2016. <span><span class="nocase">Robust hyperparameter estimation protects against hypervariable genes and improves power to detect differential expression</span>.</span> <em>The Annals of Applied Statistics</em> 10 (2): 94663. <a href="https://doi.org/10.1214/16-AOAS920">https://doi.org/10.1214/16-AOAS920</a>.
</div>
<div id="ref-limma" class="csl-entry" role="doc-biblioentry">
Ritchie, Matthew E., Belinda Phipson, Di Wu, Yifang Hu, Charity W. Law, Wei Shi, and Gordon K. Smyth. 2015. <span><span class="nocase">limma powers differential expression analyses for RNA-sequencing and microarray studies</span>.</span> <em>Nucleic Acids Research</em> 43 (7): e4747. <a href="https://doi.org/10.1093/nar/gkv007">https://doi.org/10.1093/nar/gkv007</a>.
</div>
<div id="ref-edgeR1" class="csl-entry" role="doc-biblioentry">
Robinson, Mark D., Davis J. McCarthy, and Gordon K. Smyth. 2009. <span><span class="nocase">edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</span>.</span> <em>Bioinformatics</em> 26 (1): 13940. <a href="https://doi.org/10.1093/bioinformatics/btp616">https://doi.org/10.1093/bioinformatics/btp616</a>.
</div>
<div id="ref-GSE152641" class="csl-entry" role="doc-biblioentry">
Thair, Simone A., Yudong D. He, Yehudit Hasin-Brumshtein, Suraj Sakaram, Rushika Pandya, Jiaying Toh, David Rawling, et al. 2021. <span>Transcriptomic Similarities and Differences in Host Response Between SARS-CoV-2 and Other Viral Infections.</span> <em>iScience</em> 24 (1): 101947. https://doi.org/<a href="https://doi.org/10.1016/j.isci.2020.101947">https://doi.org/10.1016/j.isci.2020.101947</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Differential%20Expression%20Analysis%3A%20edgeR%20vs%20limma&amp;url=https%3A%2F%2Fwww.ffli.dev%2Fposts%2F2021-07-26-differential-expression-analysis-edger-vs-limma%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.ffli.dev%2Fposts%2F2021-07-26-differential-expression-analysis-edger-vs-limma%2F&amp;title=Differential%20Expression%20Analysis%3A%20edgeR%20vs%20limma" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--
Buhr (2021, March 14). jmbuhr.de: Making a Darkmode for your distill site. Retrieved from
https://jmbuhr.de/posts/2021-03-14-making-a-darkmode-for-your-distill-site/
-->
<script>
const darkmodeToggle = document.getElementsByClassName("fas fa-lightbulb")[0];
let theme = localStorage.getItem("theme");

if (!theme) {
  if (window.matchMedia("(prefers-color-scheme: dark)").matches ) {
    theme = "dark";
  } else {
    theme = "light";
  }
}
setTheme();

function switchTheme() {
  if (theme === "light") {
    theme = "dark";
  } else {
    theme = "light";
  }
  localStorage.setItem("theme", theme);
  setTheme();
  console.log(theme);
}

function setTheme() {
  if (theme === "dark") {
    document.body.classList.add('darkmode');
  } else {
    document.body.classList.remove('darkmode');
  }
}

darkmodeToggle.addEventListener('click', switchTheme)
</script>
<!-- Add function to open links to external links in new tab, from: -->
<!-- https://yihui.name/en/2018/09/target-blank/ -->
<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/ff98li/ffli.dev/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/ff98li/ffli.dev">https://github.com/ff98li/ffli.dev</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Li (2021, July 26). ffli.dev: Differential Expression Analysis: edgeR vs limma. Retrieved from https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{li2021differential,
  author = {Li, Feifei},
  title = {ffli.dev: Differential Expression Analysis: edgeR vs limma},
  url = {https://www.ffli.dev/posts/2021-07-26-differential-expression-analysis-edger-vs-limma/},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<div class="footer">
    <p>
        <svg style="height:14px;fill:currentColor;" viewbox="0 0 496 512"><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532 0-200-89.451-200-200 0-110.531 89.451-200 200-200 110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43 0-140.484-61.425-140.484-141.567 0-79.152 60.275-139.401 139.762-139.401 55.531 0 88.738 26.62 97.593 34.779a11.965 11.965 0 0 1 1.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303 0-77.916 35.33-77.916 80.082 0 41.589 26.888 83.692 78.277 83.692 32.657 0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947 0 0 1-1.152 15.518z"></path></svg><script>
            if (Date.parse(document.lastModified) != 0)
                document.write(new Date().getFullYear())
        </script> Feifei Li
        <a href="https://creativecommons.org/licenses/by-sa/4.0/">
            <svg style="height:14px;fill:currentColor;" viewbox="0 0 496 512"><path d="M245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93-22.13 0-33.22 14.61-33.22 43.84 0 23.57 9.21 43.84 33.22 43.84 14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98-22.6 0-73.96-10.32-73.96-77.05 0-58.69 43-77.06 72.63-77.06 30.72-.01 52.7 11.95 65.99 35.86zm143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93-22.14 0-33.22 14.61-33.22 43.84 0 23.55 9.23 43.84 33.22 43.84 14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98-22.69 0-73.96-9.87-73.96-77.05 0-58.67 42.97-77.06 72.63-77.06 30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248 129.93 0 248.44-100.87 248.44-248 0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81 0-105.42 85.43-203.27 203.72-203.27 112.53 0 202.82 89.46 202.82 203.26-.01 121.69-99.68 202.82-202.84 202.82z"></path></svg><svg style="height:14px;fill:currentColor;" viewbox="0 0 496 512"><path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3 3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7 3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256 0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8 103.2 0 202.8-81.1 202.8-202.8.1-113.8-90.2-203.3-202.8-203.3z"></path></svg><svg style="height:14px;fill:currentColor;" viewbox="0 0 496 512"><path d="M247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256 0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8 103.2 0 202.8-81.1 202.8-202.8.1-113.8-90.2-203.3-202.8-203.3zM137.7 221c13-83.9 80.5-95.7 108.9-95.7 99.8 0 127.5 82.5 127.5 134.2 0 63.6-41 132.9-128.9 132.9-38.9 0-99.1-20-109.4-97h62.5c1.5 30.1 19.6 45.2 54.5 45.2 23.3 0 58-18.2 58-82.8 0-82.5-49.1-80.6-56.7-80.6-33.1 0-51.7 14.6-55.8 43.8h18.2l-49.2 49.2-49-49.2h19.4z"></path></svg></a>
    </p>
</div>
<p>
    <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"></path></svg>
    Made with
    <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M192 384h192c53 0 96-43 96-96h32c70.6 0 128-57.4 128-128S582.6 32 512 32H120c-13.3 0-24 10.7-24 24v232c0 53 43 96 96 96zM512 96c35.3 0 64 28.7 64 64s-28.7 64-64 64h-32V96h32zm47.7 384H48.3c-47.6 0-61-64-36-64h583.3c25 0 11.8 64-35.9 64z"></path></svg>,
    <a href="https://github.com/FortAwesome/Font-Awesome">
        <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M397.8 32H50.2C22.7 32 0 54.7 0 82.2v347.6C0 457.3 22.7 480 50.2 480h347.6c27.5 0 50.2-22.7 50.2-50.2V82.2c0-27.5-22.7-50.2-50.2-50.2zm-45.4 284.3c0 4.2-3.6 6-7.8 7.8-16.7 7.2-34.6 13.7-53.8 13.7-26.9 0-39.4-16.7-71.7-16.7-23.3 0-47.8 8.4-67.5 17.3-1.2.6-2.4.6-3.6 1.2V385c0 1.8 0 3.6-.6 4.8v1.2c-2.4 8.4-10.2 14.3-19.1 14.3-11.3 0-20.3-9-20.3-20.3V166.4c-7.8-6-13.1-15.5-13.1-26.3 0-18.5 14.9-33.5 33.5-33.5 18.5 0 33.5 14.9 33.5 33.5 0 10.8-4.8 20.3-13.1 26.3v18.5c1.8-.6 3.6-1.2 5.4-2.4 18.5-7.8 40.6-14.3 61.5-14.3 22.7 0 40.6 6 60.9 13.7 4.2 1.8 8.4 2.4 13.1 2.4 22.7 0 47.8-16.1 53.8-16.1 4.8 0 9 3.6 9 7.8v140.3z"></path></svg>
        Font Awesome 5
    </a>,
    <a href="https://github.com/ff98li/bioinfo-blog">
        <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"></path></svg>
        GitHub
    </a>,
    <a href="https://pkgs.rstudio.com/distill/index.html">
        <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>
        distill
    </a>
    and
    <a href="https://pkgs.rstudio.com/rmarkdown/">
        <svg style="height:14px;fill:currentColor;" viewbox="0 0 512 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>
        Rmarkdown
    </a>.
</p>
<p>
    <span style="font-size:0.8rem;">
        <script>
            if (Date.parse(document.lastModified) != 0)
                document.write('Last updated: ' + document.lastModified);
        </script></span>
</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
